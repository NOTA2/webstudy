# WEB2 - HTTP

## 수업소개

- 처음 웹은 크게 4가지 요소로 이루어져 있었다.
    1. HTML : 웹 페이지를 만드는 언어
    2. URL, URI : 원하는 웹페이지에 방문할 수 있도록 도와주는 주소체계 
    3. Web browser, Web server : 웹 페이지를 주고받는 소프트웨어
    4. 웹 서버와 웹 브라우저가 통신할 때 사용되는 규칙

#### HyperText Transfer Protocol
- 처음엔 단순한 통신 규약이였지만 웹이 발전해 나가면서 단순한 HTTP의 기능만으로는 성능 보안 안정성을 확보하는 것이 어려웠다.
    - 보다 풍부한 기능을 가진 프로토콜로 발전한다.
    - 텍스트 파일뿐만 아니라 멀티미디어 파일을 전송하는 매우 중요한 프로토콜이 되었다.


-----------------------------

## HTTP 소개

- HTTP는 Request와 Response를 의미한다.
    - HTML, CSS 등 여러가지 컨텐츠를 주고받기 위해서는 서버와 클라이언트가 서로 알아들을 수 있는 공통의 약속인 메시지가 필요하다.
    - 이러한 메시지를 **HTTP**라고 한다.

#### HTTP는 크게 Request와 Response 를 위한 메시지로 구분되어 있다.

- 개발자 도구에서 Network 탭을 보면 서버와 클라이언트가 주고받은 데이터(HTTP 메시지)를 볼 수 있다.

#### Headers에 있는 Request Headers는 클라이언트가 서버에게 요청한 데이터이다.
- view source를 클릭하면 날것 그래도를 볼 수 있다. 이 텍스트(메시지)를 통해 서버에게 요청한 것이다.
- 방식(GET POST), 요청 파일, 어떤 HTTP 방식을 쓸것인지, Host이름 이렇게 4가지(위 두줄)는 필수이다.

#### Headers에 있는 Response Headers는 클라이언트가 서버에게 요청한 데이터이다.
- 첫번째 줄은 어떤 방식으로 통신할 것인지, 데이터를 찾았는지 적도록 약속하였다.


### 즉, 웹 브라우저는 사용자가 요청한 정보를 서버에게 대신 물어봐 주는 프로그램이라고 할수도 있다.
- Request Header 메시지를 보내주며 요청을 한다.
- 웹 서버는 요청받은 정보를 보내고 동시에 Response Header를 만들어서 준다고 할 수 있다.
- 또한 웹 브라우저는 이렇게 받은 정보를 화면에 그려주는 기능 역시도 한다.


-----------------------------

## HTTP Request message

![](https://www.ntu.edu.sg/home/ehchua/programming/webprogramming/images/HTTP_ResponseMessageExample.png)

1. 첫번째 행은 요청행(Request Line)이라고 한다.
2. 이후의 줄들은 Request Headers라고 한다.
3. 1, 2를 합쳐서 Request Message Header라고 한다.
4. 마지막으로 서버쪽으로 전송해야할 정보가 있다면, 그 정보가 실제 내용(payload)이다. 이를 body라고 한다.
    - 그리고 header와 body는 빈줄을 넣어줘서 구분한다.

### Request Line
1. method : GET 혹은 POST 방식중 어떤 방식으로 통신할 것인지.
2. 어떤 정보를 요청하는지
3. 웹 브라우저가 현재 사용하고 있는(혹은 사용할 수 있는) HTTP 버전

### Request Headers
1. Request Headers 중 host는 필수 사항이다.
    - 하나의 웹 서버가 여러개의 도메인을 사용할 수도 있다.
        - 하나의 서버지만, 각 주소별로 다른 웹 사이트라고 한다면 웹서버는 Request Headers의 host 정보를 보고 다른 정보를 보내준다.
        - 이를 **가상호스트**라고 한다.
2. **User-Agent** : 웹 브라우저의 다른 이름. 요청을 한 웹 브라우저가 어떤 웹 브라우저인지, 사용자는 어떤 컴퓨터인지 알려준다.
    - 이를 보고 통계를 내거나 원하지 않는 접근을 차단시킬 수 있다.
3. **Accept-Encoding** : 응답하는 데이터가 많아서 이를 압축해서 전송할 경우, 어떤 압축방식을 지원하는지 적는다.
4. **If-Modified-Since** : 서버에게 여러번 요청할때, 요청시 마다 파일을 받는 것은 비효율적이니, "브라우저가 마지막으로 파일을 받은 시간"을 알려준다.
    - 서버는 자신이 가진 파일중 어떤게 더 최신인지 판단하여 전송여부를 판단한다.


-----------------------------

## HTTP Response message

![](https://image.slidesharecdn.com/computernetwork10-140901161638-phpapp01/95/computer-network-10-14-638.jpg?cb=1409588303)

1. 첫번째 줄에는 서버의 응답 상태를 알려주는 status가 나온다.
    - HTTP의 버전, status code(숫자)와 phrase(사람이 이해하도록 문자)를 통해 응답 상태를 알려준다.
        - 2xx : 응답에 성공했을 경우
        - 3xx : redirection, 즉 바로 다른 페이지로 전환하는 경우
        - 4xx : 클라이언트 쪽의 에러
            - 404 : Not Found, 없는 데이터를 요청했을 때
            - 403 : Forbidden. 접근하면 안되는 곳을 접근했을 때
        - 5xx : 서버쪽의 에러
2. **Content-Type** : 웹 서버의 응답의 종류를 알려준다.
    - text/html : 이 파일은 text이고, html언어이다. 브라우저는 이를 HTML로 해석하여 보여준다.
    - image/jpeg : 이 파일은 image이고, jpeg방식이다.
3. **Content-Length** : 응답하는 컨텐츠의 크기. 단위는 Byte
4. **Content-Encoding** : 응답한 컨텐츠의 압축 방식.
5. **Last-Modified** : 응답한 컨텐츠의 마지막 수정 시간

-----------------------

### HTTP의 동작순서

1. 웹 브라우저는 요청하기전에 Request Headers를 만든다.
    - 이때 서버에게 보내야할 정보가 있다면, 한줄 띄우고 전송할 데이터를 담는다.
2. 웹 브라우저가 인터넷을 통해서 서버에게 요청한다.(1의 메시지를 보낸다.)
3. 웹 서버는 1의 메시지(Request Message)를 보고 응답 메시지를 만든다.
    - 응답 메시지는 Response Headers가 먼저 오고, 한줄 띄우고 브라우저가 요청한 컨텐츠 붙여서 생성된다.
4. 웹 서버는 해당 메시지를 인터넷을 통해 요청한 컴퓨터로 응답한다.(3의 메시지를 보낸다.)
5. 웹 브라우저는 Response Headers와 본문의 내용을 통해서 사용자에게 화면으로 표시해준다.

-----------------------------

## 수업을 마치며

- 지금 배운것은 HTTP의 필수적인것이다.

#### 앞으로 공부해야 할 것들.
- **HTTPS, SSL** : 보다 안전한 HTTP. 데이터를 중간에 가로채도 내용을 확인할 수 없다.(암호화 되어 있기 때문)
- **Cache** : 한번 웹사이트에 접속해서 받은 정보를 또 받지 않고 이미 받은 정보를 읽어서 성능을 향상 시킨다.
    - 다만 Cache는 내용이 갱신되어도 웹 브라우저는 이를 알아채지 못한다.
    - 이 경우 Ctrl + F5 (맥 : Cmd + R | 리눅스 : F5)를 누르면 강제로 캐쉬가 갱신된다. 하지만 일반 사용자는 캐쉬가 갱신되었다는 것을 알 수 없다.
    - **cache-control, pragma** 와 같은 헤더값들을 사용하여 캐쉬를 제어한다.
- **개인화** : 웹 사이트 방문시의 기록을 웹 사이트와 서버가 가지고 있는다. (장바구니, 자동 로그인)
    - 이를 가능하게 해주는 것이 **cookie, web storage, proxy**.
        - **cookie** : 쿠키값을 브라우저에 설정하면, 접속 할때마다 설정해 놓은 쿠키값을 서버에 전송하는 것을 통해서 사용자를 식별하고 유지한다.
        - **web storage** : 쿠키보다 훨씬 많은 정보를 저장하면서도 보안적으로 우수한 기술
        - **proxy** : 웹 브라우저와 웹 서버 사이에 proxy라는 중계 서버를 두는 것.
            - 캐쉬를 대신해줌, 보안 공격을 막음, 사용자 요청을 분산
- 네트워크를 모니터링 하는 도구
    - 개발자 도구의 Network
    - **WIRESHARK** : 컴퓨터에서 일어나는 모든 네트워크 트래픽을 감시할 수 있다.
